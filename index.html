<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MPBV-Bot | Material Purchase Bill Validator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Particle Background -->
    <div class="particles" id="particles"></div>

    <!-- Guidelines Toggle & Panel -->
    <div class="guidelines-toggle" id="guidelinesToggle">
        <i class="fas fa-info"></i>
    </div>

    <div class="guidelines-panel" id="guidelinesPanel">
        <button class="close-panel" id="closePanel">
            <i class="fas fa-times"></i>
        </button>
        <h2><i class="fas fa-info-circle"></i> Validation Guidelines</h2>
        
        <h3>Bill Content Requirements</h3>
        <div class="policy-info">
            <div class="policy-item">Supplier Name (must match approved vendor list)</div>
            <div class="policy-item">Valid GSTIN (15-digit alphanumeric format)</div>
            <div class="policy-item">Bill Date (within last 60 days)</div>
            <div class="policy-item">Total Amount (numeric, positive)</div>
            <div class="policy-item">PO Number (if applicable)</div>
            <div class="policy-item">GST Bill mention or GST breakdown (CGST/SGST/IGST)</div>
            <div class="policy-item">No Performa Invoice allowed</div>
            <div class="policy-item">Must be in Company Name (not personal name)</div>
        </div>

        <h3>Approval Matrix</h3>
        <div class="policy-info">
            <div class="policy-item"><strong>Up to ₹10,000:</strong> BU Head OR Segment/Zonal Head</div>
            <div class="policy-item"><strong>₹10,001 - ₹20,000:</strong> BU Head + Finance Head</div>
            <div class="policy-item"><strong>Above ₹20,000:</strong> BU Head + Finance Head + K K Sir</div>
        </div>

        <div class="timeline">
            <div class="timeline-item">
                <div class="timeline-marker">1</div>
                <div class="timeline-content">
                    <strong>Up to ₹10,000</strong>
                    <p>BU Head OR Segment/Zonal Head approval required</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-marker">2</div>
                <div class="timeline-content">
                    <strong>₹10,001 - ₹20,000</strong>
                    <p>BU Head + Finance Head approval required</p>
                </div>
            </div>
            <div class="timeline-item">
                <div class="timeline-marker">3</div>
                <div class="timeline-content">
                    <strong>Above ₹20,000</strong>
                    <p>BU Head + Finance Head + K K Sir approval required</p>
                </div>
            </div>
        </div>

        <h3>Non-GST Bills</h3>
        <div class="policy-info">
            <p>Non-GST bills are purchase invoices that <strong>do not contain a GSTIN</strong> or <strong>lack GST breakdown</strong>.</p>
            <p style="margin: 15px 0; padding: 12px; background: rgba(255, 209, 102, 0.2); border-radius: 10px;">
                These bills are <strong>NOT marked invalid</strong> but flagged for <strong>Manual Verification</strong>.
            </p>
            <div class="policy-item">Supplier Name: Flag for Manual Verification if missing</div>
            <div class="policy-item">Bill Date: Flag for Manual Verification if older than 60 days</div>
            <div class="policy-item">Total Amount: Flag for Manual Verification if invalid</div>
            <div class="policy-item">Company Name: Flag for Manual Verification if incorrect</div>
            <div class="policy-item">Prohibited Terms: Reject if "Performa" or "Estimate" found</div>
        </div>

        <h3>Policy Compliance</h3>
        <div class="policy-info">
            <div class="policy-item">No duplicate bills allowed</div>
            <div class="policy-item">All bills must be raised in ERP within 30 days</div>
            <div class="policy-item">Avoid cash payment (flag if "Cash" mentioned without UPI justification)</div>
            <div class="policy-item">For fuel expenses: must mention KM travelled</div>
            <div class="policy-item">Company assets must be purchased in company name</div>
        </div>
    </div>

    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-file-invoice-dollar"></i>
            </div>
            <h1>MPBV-Bot</h1>
            <p>Material Purchase Bill Validator</p>
            <p>AI-Powered Validation with Gemini AI OCR Technology</p>
        </header>

        <div class="validation-steps">
            <div class="step active" id="step-upload">
                <div class="step-icon">
                    <i class="fas fa-upload"></i>
                </div>
                <div class="step-label">Upload Bill</div>
            </div>
            <div class="step" id="step-process">
                <div class="step-icon">
                    <i class="fas fa-cogs"></i>
                </div>
                <div class="step-label">AI Processing</div>
            </div>
            <div class="step" id="step-validate">
                <div class="step-icon">
                    <i class="fas fa-check-circle"></i>
                </div>
                <div class="step-label">Validation</div>
            </div>
            <div class="step" id="step-results">
                <div class="step-icon">
                    <i class="fas fa-clipboard-check"></i>
                </div>
                <div class="step-label">Results</div>
            </div>
        </div>

        <div class="main-content">
            <div class="card">
                <h2 class="card-title"><i class="fas fa-file-upload"></i> Upload Bill</h2>
                
                <div class="tab-nav">
                    <div class="tab-item active" data-tab="upload">Upload Bill</div>
                    <div class="tab-item" data-tab="extracted">Extracted Data</div>
                    <div class="tab-item" data-tab="preview">Bill Preview</div>
                </div>
                
                <div class="tab-content active" id="upload-tab">
                    <div class="upload-area" id="uploadArea">
                        <i class="fas fa-file-invoice-dollar"></i>
                        <h3>Drag & Drop your bill here</h3>
                        <p>or click to browse files</p>
                        <p>Supported formats: PDF, JPG, PNG</p>
                    </div>
                    <input type="file" id="fileInput" accept=".pdf,.jpg,.jpeg,.png" style="display: none;">
                    
                    <div class="file-info" id="fileInfo">
                        <h4>Selected File:</h4>
                        <p id="fileName"></p>
                        <p id="fileSize"></p>
                        <div class="progress-bar">
                            <div class="progress" id="uploadProgress" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
                
                <div class="tab-content" id="extracted-tab">
                    <div class="ai-processing" id="aiProcessing">
                        <i class="fas fa-brain"></i>
                        <h3>AI Processing</h3>
                        <p>Gemini AI is extracting data from your bill...</p>
                        
                        <div class="processing-steps">
                            <div class="processing-step" id="step1">
                                <i class="fas fa-file-import"></i>
                                <p>Reading Document</p>
                            </div>
                            <div class="processing-step" id="step2">
                                <i class="fas fa-search"></i>
                                <p>Analyzing Content</p>
                            </div>
                            <div class="processing-step" id="step3">
                                <i class="fas fa-cogs"></i>
                                <p>Extracting Data</p>
                            </div>
                            <div class="processing-step" id="step4">
                                <i class="fas fa-check-circle"></i>
                                <p>Completing</p>
                            </div>
                        </div>
                        
                        <div class="progress-bar">
                            <div class="progress shimmer" id="aiProgress" style="width: 0%"></div>
                        </div>
                        
                        <button class="btn btn-secondary" id="retryBtn" style="display: none; margin-top: 20px;">
                            <i class="fas fa-redo"></i> Retry Processing
                        </button>
                        
                        <!-- Error Message Section -->
                        <div class="error-message" id="processingError" style="display: none; margin-top: 20px; padding: 15px; background: rgba(255, 71, 87, 0.1); border-radius: 10px; border-left: 4px solid var(--danger);">
                            <h4><i class="fas fa-exclamation-triangle"></i> Processing Error</h4>
                            <p id="errorMessageText">An error occurred during processing. Please try again.</p>
                        </div>
                    </div>
                    
                    <div class="extracted-data" id="extractedData">
                        <h4><i class="fas fa-list-alt"></i> Extracted Bill Data</h4>
                        <div class="data-item">
                            <div>
                                <span>Supplier Name:</span>
                                <div class="extraction-status success" id="supplierStatus">
                                    <i class="fas fa-check-circle"></i>
                                    <span>Successfully extracted</span>
                                </div>
                                <div class="confidence-meter">
                                    <div class="confidence-level" id="supplierConfidence" style="width: 92%"></div>
                                </div>
                                <div class="data-confidence">92% confidence</div>
                            </div>
                            <span id="supplierName">-</span>
                        </div>
                        <div class="data-item">
                            <div>
                                <span>Bill Date:</span>
                                <div class="extraction-status success" id="dateStatus">
                                    <i class="fas fa-check-circle"></i>
                                    <span>Successfully extracted</span>
                                </div>
                                <div class="confidence-meter">
                                    <div class="confidence-level" id="dateConfidence" style="width: 95%"></div>
                                </div>
                                <div class="data-confidence">95% confidence</div>
                            </div>
                            <span id="billDate">-</span>
                        </div>
                        <div class="data-item">
                            <div>
                                <span>Total Amount:</span>
                                <div class="extraction-status success" id="amountStatus">
                                    <i class="fas fa-check-circle"></i>
                                    <span>Successfully extracted</span>
                                </div>
                                <div class="confidence-meter">
                                    <div class="confidence-level" id="amountConfidence" style="width: 98%"></div>
                                </div>
                                <div class="data-confidence">98% confidence</div>
                            </div>
                            <span id="totalAmount">-</span>
                        </div>
                        <div class="data-item">
                            <div>
                                <span>GSTIN:</span>
                                <div class="extraction-status success" id="gstinStatus">
                                    <i class="fas fa-check-circle"></i>
                                    <span>Successfully extracted</span>
                                </div>
                                <div class="confidence-meter">
                                    <div class="confidence-level" id="gstinConfidence" style="width: 90%"></div>
                                </div>
                                <div class="data-confidence">90% confidence</div>
                            </div>
                            <span id="gstin">-</span>
                        </div>
                        <div class="data-item">
                            <div>
                                <span>PO Number:</span>
                                <div class="extraction-status warning" id="poStatus">
                                    <i class="fas fa-exclamation-triangle"></i>
                                    <span>Not found in document</span>
                                </div>
                                <div class="confidence-meter">
                                    <div class="confidence-level" id="poConfidence" style="width: 0%"></div>
                                </div>
                                <div class="data-confidence">0% confidence</div>
                            </div>
                            <span id="poNumber">-</span>
                        </div>
                        <div class="data-item">
                            <div>
                                <span>Company Name:</span>
                                <div class="extraction-status success" id="companyStatus">
                                    <i class="fas fa-check-circle"></i>
                                    <span>Successfully extracted</span>
                                </div>
                                <div class="confidence-meter">
                                    <div class="confidence-level" id="companyConfidence" style="width: 88%"></div>
                                </div>
                                <div class="data-confidence">88% confidence</div>
                            </div>
                            <span id="companyName">-</span>
                        </div>
                        
                        <!-- Manual Verification Notice -->
                        <div class="manual-verification-notice" id="manualVerificationNotice" style="display: none; margin-top: 20px; padding: 15px; background: rgba(255, 209, 102, 0.1); border-radius: 10px; border-left: 4px solid var(--warning);">
                            <h4><i class="fas fa-exclamation-circle"></i> Manual Verification Required</h4>
                            <p>This bill appears to be handwritten or unclear. Please review the extracted data carefully. Some fields may require manual verification.</p>
                        </div>
                    </div>
                </div>
                
                <div class="tab-content" id="preview-tab">
                    <div class="bill-preview" id="billPreview">
                        <i class="fas fa-file-image" style="font-size: 3rem; color: var(--primary); margin-bottom: 15px;"></i>
                        <h4>Bill Preview</h4>
                        <p>Upload a bill to see preview</p>
                    </div>
                </div>


                
                <button class="btn btn-block" id="validateBtn" style="display: none; margin-top: 25px;">
                    <i class="fas fa-check-circle"></i> Validate Bill
                </button>
            </div>
            
            <div class="card">
                <h2 class="card-title"><i class="fas fa-clipboard-check"></i> Validation Results</h2>
                
                <div class="validation-result" id="validationResult">
                    <div class="result-status" id="resultStatus">
                        <i class="fas fa-check-circle"></i>
                        <span id="statusText">Bill Validated Successfully!</span>
                    </div>
                    
                    <div class="results-grid">
                        <!-- Results will be dynamically populated -->
                    </div>
                    
                    <div style="display: flex; gap: 15px; margin-top: 25px;">
                        <button class="btn btn-secondary btn-block" id="downloadReportBtn">
                            <i class="fas fa-download"></i> Download Report
                        </button>
                        <button class="btn btn-block" id="newBillBtn">
                            <i class="fas fa-plus-circle"></i> Validate Another Bill
                        </button>
                    </div>
                </div>
                
                <div id="emptyState" style="text-align: center; padding: 40px 20px;">
                    <i class="fas fa-file-invoice-dollar" style="font-size: 4rem; color: var(--primary-light); margin-bottom: 20px;"></i>
                    <h3>No Bill Validated Yet</h3>
                    <p>Upload a bill to start the validation process</p>
                </div>
            </div>
        </div>

        <div class="feature-highlights">
            <div class="feature-item">
                <div class="feature-icon">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="feature-content">
                    <h4>AI-Powered Validation</h4>
                    <p>Uses Gemini AI for accurate data extraction and validation</p>
                </div>
            </div>
            <div class="feature-item">
                <div class="feature-icon">
                    <i class="fas fa-bolt"></i>
                </div>
                <div class="feature-content">
                    <h4>Fast Processing</h4>
                    <p>Validates bills in seconds with advanced OCR technology</p>
                </div>
            </div>
            <div class="feature-item">
                <div class="feature-icon">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <div class="feature-content">
                    <h4>Policy Compliance</h4>
                    <p>Ensures all bills comply with company policies and regulations</p>
                </div>
            </div>
            <div class="feature-item">
                <div class="feature-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
                <div class="feature-content">
                    <h4>Approval Workflow</h4>
                    <p>Automatically determines required approvals based on amount</p>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Made by Satyajit</p>
        </footer>
    </div>

    <!-- Floating Action Button -->
    <div class="floating-action" id="helpBtn">
        <i class="fas fa-question"></i>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <div>
            <h4>Bill Uploaded Successfully!</h4>
            <p>Your bill is ready for validation.</p>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>